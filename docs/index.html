<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confidence Sets for Ranks • csranks</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Confidence Sets for Ranks">
<meta property="og:description" content="This package implements methods for computing confidence sets for ranks
	 from Mogstad, Romano, Shaikh, and Wilhelm (2020).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">csranks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/danielwilhelm/R-CS-ranks/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="csranks" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#csranks" class="anchor"></a>csranks</h1></div>
<p>The <code>R</code> package <code>csranks</code> implements confidence sets for ranks as in <a href="https://www.ucl.ac.uk/~uctpdwi/papers/cwp1020.pdf">Mogstad, Romano, Shaikh, and Wilhelm (2020)</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the package <code>devtools</code> if it isn’t already:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)</pre></div>
<p>Load the package <code>devtools</code>:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"devtools"</span>)</pre></div>
<p>Install the package <code>csranks</code>:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"danielwilhelm/R-CS-ranks"</span>)</pre></div>
</div>
<div id="example-pisa-ranking" class="section level2">
<h2 class="hasAnchor">
<a href="#example-pisa-ranking" class="anchor"></a>Example: PISA Ranking</h2>
<p>This example illustrates the computation of confidence sets for the ranking of countries according students’ achievements in mathematics. The following dataset contains data from the 2018 Program for International Student Assessment (PISA) study by the Organization for Economic Cooperation and Development (OECD), which can be downloaded at <a href="https://www.oecd.org/pisa/data/" class="uri">https://www.oecd.org/pisa/data/</a>. Students’ achievement is measured by the average mathematics test scores for all 15-year-old students in the study.</p>
<p>First, load the package <code>csranks</code> and the data:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">csranks</span>)
<span class="fu"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(<span class="no">pisa</span>)</pre></div>
<p>The dataframe <code>pisa</code> looks like this:</p>
<div class="sourceCode" id="cb5"><pre class="r">print(pisa)

      jurisdiction science_score science_se reading_score reading_se math_score  math_se
1        Australia      502.9646   1.795398      502.6317   1.634343   491.3600 1.939833
2          Austria      489.7804   2.777395      484.3926   2.697472   498.9423 2.970999
3          Belgium      498.7731   2.229240      492.8644   2.321973   508.0703 2.262662
4           Canada      517.9977   2.153651      520.0855   1.799716   512.0169 2.357476
5            Chile      443.5826   2.415280      452.2726   2.643766   417.4066 2.415888
6         Colombia      413.3230   3.052402      412.2951   3.251344   390.9323 2.989559
7   Czech Republic      496.7913   2.546069      490.2188   2.547851   499.4677 2.460662
8          Denmark      492.6370   1.937604      501.1299   1.795458   509.3984 1.735002
9          Estonia      530.1080   1.884569      523.0170   1.842242   523.4146 1.743602
10         Finland      521.8846   2.509515      520.0787   2.307102   507.3014 1.967920
11          France      492.9771   2.223662      492.6065   2.320979   495.4076 2.320214
12         Germany      502.9889   2.911501      498.2793   3.025408   500.0438 2.647083
13          Greece      451.6327   3.139630      457.4144   3.621000   451.3703 3.091228
14         Hungary      480.9117   2.329977      475.9867   2.250962   481.0826 2.319597
15         Iceland      475.0241   1.795502      473.9743   1.741511   495.1874 1.953083
16         Ireland      496.1136   2.214146      518.0785   2.244478   499.6329 2.198621
17          Israel      462.1966   3.618388      470.4152   3.670985   463.0345 3.498563
18           Italy      468.0117   2.429562      476.2847   2.438910   486.5899 2.780046
19           Japan      529.1354   2.593168      503.8560   2.670974   526.9733 2.471475
20           Korea      519.0073   2.802762      514.0523   2.940543   525.9330 3.121394
21          Latvia      487.2506   1.762796      478.6987   1.616856   496.1263 1.962767
22       Lithuania      482.0670   1.629237      475.8735   1.518276   481.1912 1.953282
23      Luxembourg      476.7694   1.220843      469.9854   1.125891   483.4215 1.097632
24          Mexico      419.2047   2.584009      420.4689   2.746279   408.8015 2.493226
25     Netherlands      503.3838   2.840622      484.7837   2.650864   519.2310 2.632278
26     New Zealand      508.4907   2.104634      505.7273   2.043143   494.4897 1.705943
27          Norway      490.4131   2.282508      499.4510   2.171849   500.9638 2.219045
28          Poland      511.0356   2.607236      511.8557   2.702458   515.6479 2.602085
29        Portugal      491.6773   2.773163      491.8008   2.428931   492.4874 2.684570
30 Slovak Republic      464.0476   2.278188      457.9840   2.234129   486.1649 2.555596
31        Slovenia      507.0065   1.250420      495.3456   1.232299   508.8975 1.363878
32           Spain      483.2520   1.552853            NA         NA   481.3926 1.462418
33          Sweden      499.4447   3.069711      505.7852   3.024772   502.3877 2.654251
34     Switzerland      495.2763   3.004997      483.9294   3.124322   515.3147 2.908004
35          Turkey      468.2996   2.013049      465.6317   2.171214   453.5078 2.260407
36  United Kingdom      504.6675   2.564415      503.9281   2.582591   501.7699 2.564428
37   United States      502.3800   3.317920      505.3528   3.568673   478.2447 3.235444</pre></div>
<p>Consider ranking countries according to their students’ achievement in mathematics. The scores in <code>math_score</code> are estimates of these achievements. The countries’ ranks can be estimated using the function <code><a href="reference/xrank.html">xrank()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="r">math_rank &lt;- xrank(math_score)
math_rank
 [1] 24 18 10  7 35 37 17  8  3 11 20 15 34 30 21 16 32 25  1  2 19 29 27 36  4 22 14  5 23 26  9 28 12  6 33 13 31</pre></div>
<p>These are only estimated ranks as they are computed from estimates of achievements and therefore estimation uncertainty in the estimates translates to estimation uncertainty in the ranks. The following subsections discuss two different confidence sets for assessing such estimation uncertainty in ranks: marginal and simultaneous confidence sets. Explanations and details about the differences of these two confidence sets can be found in Mogstad, Romano, Shaikh, and Wilhelm (2020). The complete R script containing this example, as well as R scripts for PISA rankings by reading and science scores, can be found in the subdirectory <code>examples/</code>.</p>
<div id="marginal-confidence-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#marginal-confidence-sets" class="anchor"></a>Marginal Confidence Sets</h3>
<p>The marginal confidence sets for the ranks are computed as follows:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">CS_marg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/csranks.html">csranks</a></span>(<span class="no">math_score</span>, <span class="no">math_se</span>, <span class="kw">coverage</span><span class="kw">=</span><span class="fl">0.95</span>, <span class="kw">simul</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">R</span><span class="kw">=</span><span class="fl">1000</span>, <span class="kw">seed</span><span class="kw">=</span><span class="fl">101</span>)
<span class="no">math_rankL_marg</span> <span class="kw">&lt;-</span> <span class="no">CS_marg</span>$<span class="no">L</span>
<span class="no">math_rankU_marg</span> <span class="kw">&lt;-</span> <span class="no">CS_marg</span>$<span class="no">U</span></pre></div>
<p>where <code>math_rankL_marg</code> and <code>math_rankL_marg</code> contain the lower and upper bounds of the confidence sets for the ranks. They can be plotted by</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="kw pkg">grid</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grid/current.viewport.html">current.viewport</a></span>()

<span class="no">plotmarg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/plotranking.html">plotranking</a></span>(<span class="kw">ranks</span><span class="kw">=</span><span class="no">math_rank</span>, <span class="kw">L</span><span class="kw">=</span><span class="no">math_rankL_marg</span>, <span class="kw">U</span><span class="kw">=</span><span class="no">math_rankU_marg</span>,
    <span class="kw">popnames</span><span class="kw">=</span><span class="no">jurisdiction</span>, <span class="kw">title</span><span class="kw">=</span><span class="st">"Ranking of OECD Countries by 2018 PISA Math Score"</span>,
    <span class="kw">subtitle</span><span class="kw">=</span><span class="st">"(with 95% marginal confidence sets)"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plotmarg</span>)</pre></div>
<p><img src="https://raw.githubusercontent.com/danielwilhelm/R-CS-ranks/master/examples/mathmarg.jpg" alt="Ranking of OECD Countries by 2018 PISA Math Score"></p>
<p>You can then save the graph by</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(<span class="st">"mathmarg.pdf"</span>, <span class="kw">plot</span><span class="kw">=</span><span class="no">plotmarg</span>)</pre></div>
</div>
<div id="simultaneous-confidence-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#simultaneous-confidence-sets" class="anchor"></a>Simultaneous Confidence Sets</h3>
<p>The simultaneous confidence sets for the ranks are computed as follows:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">CS_simul</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/csranks.html">csranks</a></span>(<span class="no">math_score</span>, <span class="no">math_se</span>, <span class="kw">coverage</span><span class="kw">=</span><span class="fl">0.95</span>, <span class="kw">simul</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">R</span><span class="kw">=</span><span class="fl">1000</span>, <span class="kw">seed</span><span class="kw">=</span><span class="fl">101</span>)
<span class="no">math_rankL_simul</span> <span class="kw">&lt;-</span> <span class="no">CS_simul</span>$<span class="no">L</span>
<span class="no">math_rankU_simul</span> <span class="kw">&lt;-</span> <span class="no">CS_simul</span>$<span class="no">U</span></pre></div>
<p>where <code>math_rankL_simul</code> and <code>math_rankL_simul</code> contain the lower and upper bounds of the confidence sets for the ranks. They can be plotted by</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="kw pkg">grid</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grid/current.viewport.html">current.viewport</a></span>()

<span class="no">plotsimul</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/plotranking.html">plotranking</a></span>(<span class="kw">ranks</span><span class="kw">=</span><span class="no">math_rank</span>, <span class="kw">L</span><span class="kw">=</span><span class="no">math_rankL_simul</span>, <span class="kw">U</span><span class="kw">=</span><span class="no">math_rankU_simul</span>,
    <span class="kw">popnames</span><span class="kw">=</span><span class="no">jurisdiction</span>, <span class="kw">title</span><span class="kw">=</span><span class="st">"Ranking of OECD Countries by 2018 PISA Math Score"</span>,
    <span class="kw">subtitle</span><span class="kw">=</span><span class="st">"(with 95% simultaneous confidence sets)"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plotsimul</span>)</pre></div>
<p><img src="https://raw.githubusercontent.com/danielwilhelm/R-CS-ranks/master/examples/mathsimul.jpg" alt="Ranking of OECD Countries by 2018 PISA Math Score"></p>
<p>You can then save the graph by</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(<span class="st">"mathsimul.pdf"</span>, <span class="kw">plot</span><span class="kw">=</span><span class="no">plotsimul</span>)</pre></div>
</div>
</div>
</div>
<div id="reference" class="section level1">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<p><a href="https://www.ucl.ac.uk/~uctpdwi/papers/cwp1020.pdf">Mogstad, Romano, Shaikh, and Wilhelm (2020), “Inference for Ranks with Applications to Mobility across Neighborhoods and Academic Achievements across Countries”, CeMMAP Working Paper CWP10/20</a></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/danielwilhelm/R-CS-ranks/">https://​github.com/​danielwilhelm/​R-CS-ranks/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/danielwilhelm/R-CS-ranks/issues">https://​github.com/​danielwilhelm/​R-CS-ranks/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing csranks</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Daniel Wilhelm <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Daniel Wilhelm.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
