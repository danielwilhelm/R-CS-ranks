<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inference for Rank-Rank Regressions • csranks</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Inference for Rank-Rank Regressions">
<meta property="og:description" content="csranks">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-2631182-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-2631182-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">csranks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Inference-for-Ranks.html">Inference for Ranks</a>
    </li>
    <li>
      <a href="../articles/Rank-Rank-Reg.html">Inference for Rank-Rank Regressions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/danielwilhelm/R-CS-ranks/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Inference for Rank-Rank Regressions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danielwilhelm/R-CS-ranks/blob/HEAD/vignettes/Rank-Rank-Reg.rmd" class="external-link"><code>vignettes/Rank-Rank-Reg.rmd</code></a></small>
      <div class="hidden name"><code>Rank-Rank-Reg.rmd</code></div>

    </div>

    
    
<p>The following example illustrates how the <code>csranks</code>
package can be used for estimation and inference in rank-rank
regressions. These are commonly used for studying intergenerational
mobility.</p>
<!-- ## Rank-Rank regression

Denote by $X$ the explanatory variable, $Y$ the outcome variable, and by 
$F_X, F_Y$ CDFs of $X$ and $Y$. We postulate a linear model between
$R_X=F_X(X)$ and $R_Y=F_Y(Y)$:

\[R_Y = c+\rho R_X\]

A naive course of action would be to estimate $R_X$ and $R_Y$ using the empirical 
cumulative distribution function and plug the results into `lm`. However, this approach
ignores the uncertainty originating from rank estimation. An individual 
with income larger than 90% of sample could have income larger than 92 or 87% of the whole
population after all. This ignorance results in inconsistent standard errors, confidence
intervals and p-values of regression coefficients $c$ and $\rho$. 

In the `csranks` package, an asymptotically correct method of calculation of those standard errors
is implemented. The key function in the workflow is `lmranks`. -->
<div class="section level2">
<h2 id="example-intergenerational-mobility">Example: Intergenerational Mobility<a class="anchor" aria-label="anchor" href="#example-intergenerational-mobility"></a>
</h2>
<p>In this example, we want to intergenerational income mobility by
estimating and performing inference on the rank correlation between
parents and their children’s incomes. The <code>csranks</code> package
contains an artificial dataset with data on children’s and parents’
household incomes, the child’s gender and race (<code>black</code>,
<code>hisp</code> or <code>neither</code>).</p>
<p>First, load the package <code>csranks</code>. Second, load the data
and take a quick look at it:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danielwilhelm/R-CS-ranks" class="external-link">csranks</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="co">#&gt;    c_faminc  p_faminc gender    race</span></span>
<span><span class="co">#&gt; 1  78771.72 77127.484 female neither</span></span>
<span><span class="co">#&gt; 2  79268.33 62723.303 female neither</span></span>
<span><span class="co">#&gt; 3  45405.98 65751.340   male neither</span></span>
<span><span class="co">#&gt; 4  81951.64 58723.050   male neither</span></span>
<span><span class="co">#&gt; 5  88350.33  6381.047   male neither</span></span>
<span><span class="co">#&gt; 6 161331.33 40325.466 female neither</span></span></code></pre></div>
<div class="section level3">
<h3 id="rank-rank-regression">Rank-rank regression<a class="anchor" aria-label="anchor" href="#rank-rank-regression"></a>
</h3>
<p>In economics, it is common to estimate measures of mobility by
running rank-rank regressions. For instance, the rank correlation
between parents’ and children’s incomes can be estimated by running a
regression of a child’s income rank on the parent’s income rank:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmr_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmranks.html">lmranks</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">c_faminc</span><span class="op">)</span> <span class="op">~</span> <span class="fu">r</span><span class="op">(</span><span class="va">p_faminc</span><span class="op">)</span>, data<span class="op">=</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmr_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; The number of residual degrees of freedom is not correct.</span></span>
<span><span class="co">#&gt; Also, z-value, not t-value, since the distribution used for p-value calculation</span></span>
<span><span class="co">#&gt; is standard normal.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lmranks(formula = r(c_faminc) ~ r(p_faminc), data = parent_child_income)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.65601 -0.21986 -0.00376  0.22088  0.66495 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 0.312311   0.007161   43.61   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; r(p_faminc) 0.375538   0.014319   26.23   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: NA on 3892 degrees of freedom</span></span></code></pre></div>
<p>This regression specification takes each child’s income
(<code>c_faminc</code>), computes its rank among all children’s incomes,
then takes each parent’s income (<code>p_faminc</code>) and computes its
rank among all parents’ incomes. Then the child’s rank is regressed on
the parent’s rank using OLS. The <code>lmranks</code> function computes
standard errors, t-values and p-values according to the asymptotic
theory developed in Chetverikov and Wilhelm (2023).</p>
<p>A naive approach, which <strong>does not</strong> lead to valid
inference, would compute the children’s and parents’ ranks first and the
run a standard OLS regression afterwards:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c_faminc_rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/irank.html">frank</a></span><span class="op">(</span><span class="va">parent_child_income</span><span class="op">$</span><span class="va">c_faminc</span>, omega<span class="op">=</span><span class="fl">1</span>, increasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p_faminc_rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/irank.html">frank</a></span><span class="op">(</span><span class="va">parent_child_income</span><span class="op">$</span><span class="va">p_faminc</span>, omega<span class="op">=</span><span class="fl">1</span>, increasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">c_faminc_rank</span> <span class="op">~</span> <span class="va">p_faminc_rank</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = c_faminc_rank ~ p_faminc_rank)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.65601 -0.21986 -0.00376  0.22088  0.66495 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   0.312311   0.008579   36.41   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank 0.375538   0.014856   25.28   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2676 on 3892 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.141,  Adjusted R-squared:  0.1408 </span></span>
<span><span class="co">#&gt; F-statistic:   639 on 1 and 3892 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Notice that the point estimates of the intercept and slope are the
same as those of the <code>lmranks</code> function. However, the
standard errors, t-values and p-values differ. This is because the usual
OLS formulas for standard errors do not take into account the estimation
uncertainty in the ranks.</p>
<p>One can also run the rank-rank regression with additional covariates,
e.g.:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmr_model_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmranks.html">lmranks</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">c_faminc</span><span class="op">)</span> <span class="op">~</span> <span class="fu">r</span><span class="op">(</span><span class="va">p_faminc</span><span class="op">)</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">race</span>, data<span class="op">=</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmr_model_cov</span><span class="op">)</span></span>
<span><span class="co">#&gt; The number of residual degrees of freedom is not correct.</span></span>
<span><span class="co">#&gt; Also, z-value, not t-value, since the distribution used for p-value calculation</span></span>
<span><span class="co">#&gt; is standard normal.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lmranks(formula = r(c_faminc) ~ r(p_faminc) + gender + race, </span></span>
<span><span class="co">#&gt;     data = parent_child_income)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.66140 -0.20654 -0.00343  0.21421  0.72917 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.299823   0.018155  16.514  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; r(p_faminc)  0.323785   0.015123  21.411  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; gendermale   0.010862   0.008484   1.280  0.20042    </span></span>
<span><span class="co">#&gt; raceblack   -0.088215   0.020910  -4.219 2.46e-05 ***</span></span>
<span><span class="co">#&gt; raceneither  0.055726   0.018781   2.967  0.00301 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: NA on 3889 degrees of freedom</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="grouped-rank-rank-regression">Grouped rank-rank regression<a class="anchor" aria-label="anchor" href="#grouped-rank-rank-regression"></a>
</h3>
<p>In some economic applications, it is desired to run rank-rank
regressions separately in subgroups of the population, but compute the
ranks in the whole population. For instance, we might want to estimate
rank-rank regression slopes as measures of intergenerational mobility
separately for males and females, but the ranking of children’s incomes
is formed among all children (rather than form separate rankings for
males and females).</p>
<p>Such regressions can easily be run using the <code>lmranks</code>
function and interaction notation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grouped_lmr_model_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmranks.html">lmranks</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">c_faminc</span><span class="op">)</span> <span class="op">~</span> <span class="fu">r</span><span class="op">(</span><span class="va">p_faminc_rank</span><span class="op">)</span><span class="op">:</span><span class="va">gender</span>, </span>
<span>                             data<span class="op">=</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">grouped_lmr_model_simple</span><span class="op">)</span></span>
<span><span class="co">#&gt; The number of residual degrees of freedom is not correct.</span></span>
<span><span class="co">#&gt; Also, z-value, not t-value, since the distribution used for p-value calculation</span></span>
<span><span class="co">#&gt; is standard normal.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lmranks(formula = r(c_faminc) ~ r(p_faminc_rank):gender, data = parent_child_income)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.65016 -0.21977 -0.00308  0.21750  0.68833 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; genderfemale                   0.28796    0.01119   25.74   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; gendermale                     0.33506    0.01107   30.27   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):genderfemale  0.40800    0.02046   19.94   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):gendermale    0.34516    0.02044   16.89   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: NA on 3890 degrees of freedom</span></span></code></pre></div>
<p>In this example, we have run a separate OLS regression of children’s
ranks on parents’ ranks among the female and male children. However,
incomes of children are ranked among all children and incomes of parents
are ranked among all parents. The standard errors, t-values and p-values
are implemented according to the asymptotic theory developed in
Chetverikov and Wilhelm (2023), where it is shown that the asymptotic
distribution of the estimators now need to not only account for the fact
that ranks are estimated, but also for the fact that estimators are
correlated across gender subgroups because they use the same estimated
ranking.</p>
<p>A naive application of the <code>lm</code> function would produce the
same point estimates, but <strong>not</strong> the correct standard
errors:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grouped_lm_model_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">c_faminc_rank</span> <span class="op">~</span> <span class="va">p_faminc_rank</span><span class="op">:</span><span class="va">gender</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">-</span> <span class="fl">1</span>, <span class="co">#group-wise intercept</span></span>
<span>                       data<span class="op">=</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">grouped_lm_model_simple</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = c_faminc_rank ~ p_faminc_rank:gender + gender - </span></span>
<span><span class="co">#&gt;     1, data = parent_child_income)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.65016 -0.21977 -0.00308  0.21750  0.68833 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                            Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; genderfemale                0.28796    0.01233   23.35   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; gendermale                  0.33506    0.01192   28.10   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:genderfemale  0.40800    0.02135   19.11   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:gendermale    0.34516    0.02066   16.71   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2674 on 3890 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7858, Adjusted R-squared:  0.7855 </span></span>
<span><span class="co">#&gt; F-statistic:  3567 on 4 and 3890 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>One can also create more granular subgroups by interacting several
characteristics such as gender and race:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parent_child_income</span><span class="op">$</span><span class="va">subgroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">parent_child_income</span><span class="op">$</span><span class="va">gender</span>, <span class="va">parent_child_income</span><span class="op">$</span><span class="va">race</span><span class="op">)</span></span>
<span><span class="va">grouped_lmr_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmranks.html">lmranks</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">c_faminc</span><span class="op">)</span> <span class="op">~</span> <span class="fu">r</span><span class="op">(</span><span class="va">p_faminc_rank</span><span class="op">)</span><span class="op">:</span><span class="va">subgroup</span>, </span>
<span>                             data<span class="op">=</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">grouped_lmr_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; The number of residual degrees of freedom is not correct.</span></span>
<span><span class="co">#&gt; Also, z-value, not t-value, since the distribution used for p-value calculation</span></span>
<span><span class="co">#&gt; is standard normal.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lmranks(formula = r(c_faminc) ~ r(p_faminc_rank):subgroup, data = parent_child_income)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.65574 -0.20769 -0.00387  0.21297  0.73248 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                         Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; subgroupfemale.hisp                      0.26280    0.03268   8.041 8.94e-16</span></span>
<span><span class="co">#&gt; subgroupmale.hisp                        0.35313    0.04516   7.820 5.26e-15</span></span>
<span><span class="co">#&gt; subgroupfemale.black                     0.19741    0.01968  10.031  &lt; 2e-16</span></span>
<span><span class="co">#&gt; subgroupmale.black                       0.26496    0.02702   9.805  &lt; 2e-16</span></span>
<span><span class="co">#&gt; subgroupfemale.neither                   0.35096    0.01525  23.006  &lt; 2e-16</span></span>
<span><span class="co">#&gt; subgroupmale.neither                     0.36603    0.01322  27.694  &lt; 2e-16</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupfemale.hisp     0.41733    0.07602   5.490 4.02e-08</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupmale.hisp       0.21780    0.09697   2.246 0.024694</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupfemale.black    0.30798    0.05154   5.976 2.29e-09</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupmale.black      0.25528    0.07234   3.529 0.000417</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupfemale.neither  0.33908    0.02532  13.390  &lt; 2e-16</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupmale.neither    0.31818    0.02270  14.018  &lt; 2e-16</span></span>
<span><span class="co">#&gt;                                            </span></span>
<span><span class="co">#&gt; subgroupfemale.hisp                     ***</span></span>
<span><span class="co">#&gt; subgroupmale.hisp                       ***</span></span>
<span><span class="co">#&gt; subgroupfemale.black                    ***</span></span>
<span><span class="co">#&gt; subgroupmale.black                      ***</span></span>
<span><span class="co">#&gt; subgroupfemale.neither                  ***</span></span>
<span><span class="co">#&gt; subgroupmale.neither                    ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupfemale.hisp    ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupmale.hisp      *  </span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupfemale.black   ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupmale.black     ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupfemale.neither ***</span></span>
<span><span class="co">#&gt; r(p_faminc_rank):subgroupmale.neither   ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: NA on 3882 degrees of freedom</span></span></code></pre></div>
<p>Let’s compare the confidence intervals for regression coefficients
produced by <code>lmranks</code> and naive approaches.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grouped_lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">c_faminc_rank</span> <span class="op">~</span> <span class="va">p_faminc_rank</span><span class="op">:</span><span class="va">subgroup</span> <span class="op">+</span> <span class="va">subgroup</span> <span class="op">-</span> <span class="fl">1</span>, <span class="co">#group-wise intercept</span></span>
<span>                       data<span class="op">=</span><span class="va">parent_child_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">grouped_lm_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = c_faminc_rank ~ p_faminc_rank:subgroup + subgroup - </span></span>
<span><span class="co">#&gt;     1, data = parent_child_income)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.65574 -0.20769 -0.00387  0.21297  0.73248 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; subgroupfemale.hisp                   0.26280    0.03531   7.443 1.20e-13 ***</span></span>
<span><span class="co">#&gt; subgroupmale.hisp                     0.35313    0.04083   8.649  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; subgroupfemale.black                  0.19741    0.02397   8.236 2.41e-16 ***</span></span>
<span><span class="co">#&gt; subgroupmale.black                    0.26496    0.02731   9.701  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; subgroupfemale.neither                0.35096    0.01561  22.481  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; subgroupmale.neither                  0.36603    0.01394  26.265  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:subgroupfemale.hisp     0.41733    0.07490   5.572 2.69e-08 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:subgroupmale.hisp       0.21780    0.08722   2.497 0.012563 *  </span></span>
<span><span class="co">#&gt; p_faminc_rank:subgroupfemale.black    0.30798    0.06121   5.032 5.08e-07 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:subgroupmale.black      0.25528    0.06926   3.686 0.000231 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:subgroupfemale.neither  0.33908    0.02536  13.370  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; p_faminc_rank:subgroupmale.neither    0.31818    0.02300  13.831  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2633 on 3882 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7927, Adjusted R-squared:  0.792 </span></span>
<span><span class="co">#&gt; F-statistic:  1237 on 12 and 3882 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ci_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lmr_model</span><span class="op">)</span>, </span>
<span>                    parameter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"slope"</span><span class="op">)</span>,</span>
<span>                    group<span class="op">=</span><span class="st">"Whole sample"</span>,</span>
<span>                    method<span class="op">=</span><span class="st">"csranks"</span>, </span>
<span>                    lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lmr_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, </span>
<span>                    upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lmr_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ci_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ci_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">grouped_lmr_model</span><span class="op">)</span>,</span>
<span>    parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"slope"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hispanic female"</span>, <span class="st">"Hispanic male"</span>, <span class="st">"Black female"</span>, <span class="st">"Black male"</span>, </span>
<span>                  <span class="st">"Other female"</span>, <span class="st">"Other male"</span><span class="op">)</span>, times<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    method<span class="op">=</span><span class="st">"csranks"</span>,</span>
<span>    lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">grouped_lmr_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">grouped_lmr_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ci_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ci_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span>,</span>
<span>    parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"slope"</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Whole sample"</span>,</span>
<span>    method<span class="op">=</span><span class="st">"naive"</span>,</span>
<span>    lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ci_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ci_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">grouped_lm_model</span><span class="op">)</span>,</span>
<span>    parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"slope"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hispanic female"</span>, <span class="st">"Hispanic male"</span>, <span class="st">"Black female"</span>, <span class="st">"Black male"</span>, </span>
<span>                  <span class="st">"Other female"</span>, <span class="st">"Other male"</span><span class="op">)</span>, times<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    method<span class="op">=</span><span class="st">"naive"</span>,</span>
<span>    lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">grouped_lm_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">grouped_lm_model</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ci_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">estimate</span>, x<span class="op">=</span><span class="va">group</span>, ymin<span class="op">=</span><span class="va">lower</span>, ymax<span class="op">=</span><span class="va">upper</span>,col<span class="op">=</span><span class="va">method</span>, fill<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge2</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge2</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">estimate</span><span class="op">)</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ci_data</span>, <span class="va">group</span><span class="op">==</span><span class="st">"Whole sample"</span><span class="op">)</span>,</span>
<span>               linetype<span class="op">=</span><span class="st">"dashed"</span>,</span>
<span>               col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"95% confidence intervals of intercept and slope\nin rank-rank regression"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span><span class="op">)</span></span></code></pre></div>
<p><img src="Rank-Rank-Reg_files/figure-html/plot_CIs-1.png" width="90%"></p>
<p>The coefficient calculated for the whole sample has a narrow
confidence interval, which is expected. In this example, there are some
differences in the correct (<code>csranks</code>) confidence intervals
and the incorrect (<code>naive</code>) confidence intervals, but they
are rather small. The paper by Chetverikov and Wilhelm (2023), however,
provides empirical examples in which the differences can be quite
large.</p>
</div>
</div>
<div class="section level2">
<h2 id="reference-further-reading">Reference &amp; further reading<a class="anchor" aria-label="anchor" href="#reference-further-reading"></a>
</h2>
<p><a href="https://arxiv.org/pdf/2310.15512.pdf" class="external-link">Chetverikov and
Wilhelm (2023), “Inference for Rank-Rank Regressions”. arXiv preprint
arXiv:2310.15512</a></p>
<p>Check out the documentation of individual functions at the package’s
<a href="https://danielwilhelm.github.io/R-CS-ranks/" class="external-link">website</a> and
further examples in the package’s <a href="https://github.com/danielwilhelm/R-CS-ranks/tree/master/examples" class="external-link">Github
repository</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://www.ucl.ac.uk/~uctpdwi/" class="external-link">Daniel Wilhelm</a>, Pawel Morgen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
